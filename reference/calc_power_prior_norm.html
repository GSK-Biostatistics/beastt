<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Power Prior Normal — calc_power_prior_norm • beastt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Power Prior Normal — calc_power_prior_norm"><meta name="description" content="Calculate a (potentially inverse probability weighted) normal
power prior using external data."><meta property="og:description" content="Calculate a (potentially inverse probability weighted) normal
power prior using external data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">beastt</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/binary.html">Binary Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/continuous.html">Normal Outcome (Known SD)</a></li>
    <li><a class="dropdown-item" href="../articles/tte.html">Time-to-Event Outcome</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GSK-Biostatistics/beastt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Power Prior Normal</h1>
      <small class="dont-index">Source: <a href="https://github.com/GSK-Biostatistics/beastt/blob/main/R/pwr_prior.R" class="external-link"><code>R/pwr_prior.R</code></a></small>
      <div class="d-none name"><code>calc_power_prior_norm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate a (potentially inverse probability weighted) normal
power prior using external data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_power_prior_norm</span><span class="op">(</span></span>
<span>  <span class="va">external_data</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  external_sd <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-external-data">external_data<a class="anchor" aria-label="anchor" href="#arg-external-data"></a></dt>
<dd><p>This can either be a <code>prop_scr_obj</code> created by calling
<code>create_prop_scr()</code> or a tibble of the external data. If it is just a
tibble the weights will be assumed to be 1. Only the external data for the
arm(s) of interest should be included in this object (e.g., external
control data if creating a power prior for the control mean)</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Name of response variable</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Either <code>NULL</code> or a normal distributional object that is the
initial prior for the parameter of interest (e.g., control mean) before the
external data are observed</p></dd>


<dt id="arg-external-sd">external_sd<a class="anchor" aria-label="anchor" href="#arg-external-sd"></a></dt>
<dd><p>Standard deviation of external response data if assumed
known. It can be left as <code>NULL</code> if assumed unknown</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Normal power prior object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Weighted participant-level response data from an external study are
incorporated into an inverse probability weighted (IPW) power prior for the
parameter of interest \(\theta\) (e.g., the control mean if borrowing
from an external control arm). When borrowing information from an external
dataset of size \(N_{E}\), the IPW likelihood of the external response
data \(\boldsymbol{y}_E\) with weights \(\hat{\boldsymbol{a}}_0\) is defined as</p>
<p>$$\mathcal{L}_E(\theta \mid \boldsymbol{y}_E, \hat{\boldsymbol{a}}_0,
  \sigma_{E}^2) \propto \exp \left( -\frac{1}{2 \sigma_{E}^2}
  \sum_{i=1}^{N_{E}} \hat{a}_{0i} (y_i - \theta)^2 \right).$$</p>
<p>The <code>prior</code> argument should be either a distributional object with a family
type of <code>normal</code> or <code>NULL</code>, corresponding to the use of a normal initial
prior or an improper uniform initial prior (i.e., \(\pi(\theta) \propto
  1\)), respectively.</p>
<p>The <code>external_sd</code> argument can be a positive value if the external standard
deviation is assumed known or left as <code>NULL</code> otherwise. If <code>external_sd = NULL</code>, then <code>prior</code> must be <code>NULL</code> to indicate the use of an improper
uniform initial prior for \(\theta\), and an improper prior is defined
for the unknown external standard deviation such that \(\pi(\sigma_E^2)
  \propto (\sigma_E^2)^{-1}\). The details of the IPW power prior for each
case are as follows:</p><dl><dt><code>external_sd = positive value</code> (\(\sigma_E^2\) known):</dt>
<dd><p>With
either a proper normal or an improper uniform initial prior, the IPW
weighted power prior for \(\theta\) is a normal distribution.</p></dd>

<dt><code>external_sd = NULL</code> (\(\sigma_E^2\) unknown):</dt>
<dd><p>With improper
priors for both \(\theta\) and \(\sigma_E^2\), the marginal IPW weighted
power prior for \(\theta\) after integrating over \(\sigma_E^2\) is
a non-standardized \(t\) distribution.</p></dd>


</dl><p>Defining the weights \(\hat{\boldsymbol{a}}_0\) to equal 1 results in a
conventional normal (or \(t\)) power prior if the external standard
deviation is known (unknown).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other power prior:
<code><a href="calc_power_prior_beta.html">calc_power_prior_beta</a>()</code>,
<code><a href="calc_power_prior_weibull.html">calc_power_prior_weibull</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/" class="external-link">distributional</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This function can be used directly on the data</span></span></span>
<span class="r-in"><span><span class="fu">calc_power_prior_norm</span><span class="op">(</span><span class="va">ex_norm_df</span>,</span></span>
<span class="r-in"><span>                      response <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>                      prior <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      external_sd <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;distribution[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] N(0.59, 0.00015)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or this function can be used with a propensity score object</span></span></span>
<span class="r-in"><span><span class="va">ps_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_prop_scr.html">calc_prop_scr</a></span><span class="op">(</span>internal_df <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">int_norm_df</span>, <span class="va">trt</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        external_df <span class="op">=</span> <span class="va">ex_norm_df</span>,</span></span>
<span class="r-in"><span>                        id_col <span class="op">=</span> <span class="va">subjid</span>,</span></span>
<span class="r-in"><span>                        model <span class="op">=</span> <span class="op">~</span> <span class="va">cov1</span> <span class="op">+</span> <span class="va">cov2</span> <span class="op">+</span> <span class="va">cov3</span> <span class="op">+</span> <span class="va">cov4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">calc_power_prior_norm</span><span class="op">(</span><span class="va">ps_obj</span>,</span></span>
<span class="r-in"><span>                      response <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>                      prior <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      external_sd <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;distribution[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] N(0.69, 0.00037)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christina Fillmore, Ben Arancibia, Nate Bean, Abi Terry, GlaxoSmithKline Research &amp; Development Limited.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

